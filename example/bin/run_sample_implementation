#!/usr/bin/php

<?php
include_once dirname(dirname(__DIR__)) . '/src/PHPUnitDistributed/phpunitdistributed_common.php';

use PHPUnitDistributed\Util\Witness;
use PHPUnitDistributed\Util\Shell;
use PHPUnitDistributed\PHPUnit\Configuration;
use PHPUnitDistributed\PHPUnit\RunDistributedMaster;
use PHPUnitDistributed\TestDivisionStrategy\TestCount;

$app_dir = '/your/app/dir/goes/here/';

// The hostnames of the slaves
$slaves = array(
	'slave_host_01.your-network.net',
	'slave_host_02.your-network.net',
	'slave_host_03.your-network.net',
);

// See src/PHPUnitDistributed/PHPUnit/Configuration.php
$config = new Configuration(
	$app_dir,
	'/var/out/result.xml',
	array(),
	array($app_dir . 'test'),
	$app_dir . 'test/setup.php',
	true
);

// See src/PHPUnitDistributed/PHPUnit/RunDistributedMaster.php
$runner = new RunDistributedMaster(
        $config,
        $slaves,
        new TestCount(),
        array('.git*', 'conf/conf_set.conf'),
        true
);

$runner->run();